<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Carrito de Compras - GeekXpress</title>
  <link href="../assets/css/carrito.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

  <div class="container mt-4">
    <h2 class="titulo text-center">ðŸ›’ Carrito de Compras</h2>

    <!-- AquÃ­ se renderizan dinÃ¡micamente los productos -->
    <ul id="lista-carrito" class="list-group mt-3"></ul>

    <!-- BotÃ³n vaciar carrito -->
    <button id="vaciar-carrito" class="btn btn-danger mt-3 w-100">Vaciar Carrito</button>

    <!-- SecciÃ³n de totales -->
    <div class="linea d-flex justify-content-between mt-3">
      <span>EnvÃ­o</span>
      <span class="gratis">Â¡Gratis!</span>
    </div>
    <div class="linea d-flex justify-content-between">
      <strong>Total</strong>
      <strong id="total">$0</strong>
    </div>

    <!-- BotÃ³n de pago -->
    <button id="btn-pago" class="btn btn-success w-100 mt-3">Proceder al Pago</button>
  </div>

  <!-- Icono carrito (para animaciÃ³n del JS) -->
  <div id="icono-carrito" class="position-fixed" style="right: 10px; top: 10px; font-size: 2rem; cursor: pointer;">
    ðŸ›’ <span id="contador" class="badge bg-danger">0</span>
  </div>

  <script src="../assets/js/carrito.js"></script>
  <script src="../assets/js/loadTemplates.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="../assets/js/vistaCarrito.js"></script>

  <script>
    // Extra: actualizar el total en el DOM
    function actualizarTotal() {
      let carrito = JSON.parse(localStorage.getItem('carrito')) || [];
      let total = carrito.reduce((acc, item) => acc + (item.precio * item.cantidad), 0);
      document.getElementById('total').textContent = `$${total.toLocaleString()}`;
    }

    // Sobrescribimos un poco tu funciÃ³n existente
    const _actualizarCarrito = actualizarCarrito;
    actualizarCarrito = function() {
      _actualizarCarrito(); // ejecuta la funciÃ³n original
      actualizarTotal();    // actualiza el total en pantalla
    };

    // AcciÃ³n del botÃ³n de pago
    document.addEventListener('DOMContentLoaded', () => {
      const btnPago = document.getElementById('btn-pago');
      btnPago.addEventListener('click', () => {
        let carrito = JSON.parse(localStorage.getItem('carrito')) || [];
        if (carrito.length === 0) {
          alert("Tu carrito estÃ¡ vacÃ­o.");
        } else {
          alert("âœ… Procediendo al pago con " + carrito.length + " productos.");
          // AquÃ­ puedes redirigir a una pÃ¡gina de checkout real
          // window.location.href = "checkout.html";
        }
      });
    });
  </script>
</body>
</html>
